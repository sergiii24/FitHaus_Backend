stage('Build Environment') {
        steps{
            sh 'pip install -r requirements-dev.txt'
        }
    }

                sh 'pip install pylint'
            sh ''' cd app; pwd; pylint -d C0301 -d C0114 -d C0115 -d W0223 */** '''
            echo "Code Coverage"
            sh ''' coverage run -m unittest discover '''
            sh ''' python -m coverage xml -o reports/coverage.xml '''

    stage('Static code metrics') {
        steps {
            echo "Style check"
            sh ''' pylint -d C0301 **/*.py '''
            echo "Code Coverage"
            sh ''' coverage run -m unittest discover '''
            sh ''' python -m coverage xml -o reports/coverage.xml '''
        }
        post{
            always{
                step([$class: 'CoberturaPublisher',
                        autoUpdateHealth: false,
                        autoUpdateStability: false,
                        coberturaReportFile: 'reports/coverage.xml',
                        failNoReports: false,
                        failUnhealthy: false,
                        failUnstable: false,
                        maxNumberOfBuilds: 10,
                        onlyStable: false,
                        sourceEncoding: 'ASCII',
                        zoomCoverageChart: false])
            }
        }
    }